<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Pure JS Click Trainer — Cute Mode</title>
    <style>
    :root{
      /* Light, playful palette (aligns with whack-a-mole vibe) */
      --bg1:#faf8ff; --bg2:#f7f3ff;
      --ink:#2b2546; --muted:#6a648a;
      --panel:#ffffff; --panel-2:#f3efff;
      --line:#ebe7ff;
      --ok:#42c58a;    /* green = left click */
      --warn:#ff6b81;  /* red   = right click */
      --info:#69a6ff;  /* blue  = double click */
      --shadow: 0 12px 30px rgba(43,37,70,.12);
      --shadow-2: 0 6px 16px rgba(43,37,70,.10);
      --radius:18px; --chip:12px;
    }

    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      font:16px/1.45 ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial;
      color:var(--ink);
      background:
        radial-gradient(1200px 800px at 100% -10%, #e7e1ff 0%, transparent 60%),
        radial-gradient(900px 600px at -20% 20%, #ffeaf0 0%, transparent 55%),
        linear-gradient(var(--bg1), var(--bg2) 60%);
      display:flex; align-items:center; justify-content:center; min-height:100svh;
    }

    .wrap{ width:min(980px,95vw); padding:16px 16px 28px }

    header{
      display:flex; gap:16px; align-items:center; justify-content:space-between; margin-bottom:10px;
    }

    /* Legend chips */
    .legend{ display:flex; gap:10px; align-items:center; flex-wrap:wrap }
    .dot{
      height:26px; min-width:58px; padding:0 10px;
      display:flex; align-items:center; justify-content:center;
      font-size:.78rem; font-weight:700; color:#fff;
      border-radius:999px; box-shadow: var(--shadow-2);
    }
    .dot.left{  background: linear-gradient(180deg, #5fe3a6, var(--ok)); }
    .dot.right{ background: linear-gradient(180deg, #ff8aa0, var(--warn)); }
    .dot.double{background: linear-gradient(180deg, #8fc0ff, var(--info)); }
    .hint{ color:var(--muted); font-size:.92rem }

    /* Controls */
    .controls{ display:flex; gap:10px; align-items:center; flex-wrap:wrap }
    button{
      background:linear-gradient(180deg, #fff, #f3f0ff);
      color:var(--ink); border:1px solid var(--line);
      border-radius:14px; padding:10px 16px; font-weight:800; letter-spacing:.2px;
      cursor:pointer; box-shadow: var(--shadow); transition: transform .08s ease, filter .12s ease;
    }
    button:hover{ transform: translateY(-1px) }
    button:active{ transform: translateY(0); filter:brightness(.98) }
    button:disabled{ opacity:.55; cursor:not-allowed; filter:grayscale(.1) }

    input[type="number"]{
      width:90px; padding:8px 10px;
      border-radius:12px; border:1px solid var(--line);
      background:#fff; color:var(--ink); box-shadow: var(--shadow-2);
      font-weight:600;
    }

    /* Stats -> cute chips */
    .stats{
      display:flex; gap:12px; flex-wrap:wrap; margin:12px 0 14px;
    }
    .stat{
      display:flex; gap:8px; align-items:center;
      background: linear-gradient(180deg, var(--panel), var(--panel-2));
      border:1px solid var(--line); border-radius: var(--chip);
      padding:8px 12px; box-shadow: var(--shadow); font-weight:700;
    }
    .stat b{ font-variant-numeric: tabular-nums; font-size:1.05rem }

    /* Arena card */
    .arena{
      position:relative; height:520px; border-radius:var(--radius); overflow:hidden;
      background:
        radial-gradient(160px 60px at 70% 10%, #fff6 0%, #fff0 70%),
        radial-gradient(140px 60px at 25% 12%, #fff6 0%, #fff0 72%),
        repeating-linear-gradient(0deg, #faf9ff 0 18px, #f2efff 18px 19px);
      border:1px solid var(--line);
      box-shadow: var(--shadow);
      user-select:none; -webkit-user-select:none;
    }

    /* Targets */
    .target{
      position:absolute; width:70px; height:70px; border-radius:50%;
      display:grid; place-items:center; font-weight:800; font-size:.9rem; color:white;
      text-shadow:0 1px 3px rgba(0,0,0,.25);
      box-shadow: 0 12px 26px rgba(0,0,0,.20), inset 0 0 0 2px rgba(255,255,255,.18);
      transform:translate(-50%,-50%) scale(.86); opacity:0;
      transition:opacity .14s ease, transform .14s ease, filter .14s ease;
      border:1px solid #ffffff22;
    }
    .target.show{ opacity:1; transform:translate(-50%,-50%) scale(1) }
    .target.left  { background: linear-gradient(145deg, #58ebb3, var(--ok)); }
    .target.right { background: linear-gradient(145deg, #ff8c97, var(--warn)); }
    .target.double{ background: linear-gradient(145deg, #9accff, var(--info)); }
    .target:active{ filter: brightness(.96) }

    /* End overlay card */
    .endcard{
      position:absolute; inset:0; display:none; place-items:center;
      background:linear-gradient(#0b062d22,#0b062d55); backdrop-filter: blur(3px);
    }
    .endcard.show{ display:grid }
    .card{
      background:var(--panel); border:1px solid var(--line); border-radius:16px; padding:18px 20px; width:min(520px,92%);
      text-align:center; box-shadow: var(--shadow);
    }
    .card h2{ margin:0 0 8px }

    .kbd{
      font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, monospace; font-size:.9rem;
      background:#fff; border:1px solid var(--line); padding:2px 6px; border-radius:6px; color:var(--ink);
      box-shadow: var(--shadow-2);
    }

    /* Feedback animations */
    @keyframes pulse{ 0%{transform:scale(1)} 40%{transform:scale(1.12)} 100%{transform:scale(1)} }
    @keyframes shake{ 0%,100%{transform:translateX(0)} 25%{transform:translateX(-3px)} 75%{transform:translateX(3px)} }
    .pulse{ animation: pulse .22s ease }
    .shake{ animation: shake .18s ease }

    /* Click ripple */
    .ripple{
      position:absolute; pointer-events:none; inset:auto;
      width:14px; height:14px; border-radius:999px; background:#0002;
      transform: translate(-50%,-50%) scale(1);
      animation: pop .6s ease forwards;
    }
    @keyframes pop{ to { transform: translate(-50%,-50%) scale(12); opacity:0 } }
  </style>
</head>
<body>
<div class="wrap">
    <header>
        <div class="legend hint">
            <span class="dot left">Left</span>
            <span class="dot right">Right</span>
            <span class="dot double">2x</span>
        </div>
        <div class="controls">
            <label class="hint">Seconds:
                <input id="seconds" type="number" min="10" max="300" step="5" value="60">
            </label>
            <button id="startBtn">Start</button>
            <button id="resetBtn" disabled>Reset</button>
        </div>
    </header>

    <div class="stats">
        <div class="stat">Time: <b id="time">60</b>s</div>
        <div class="stat">Score: <b id="score">0</b></div>
        <div class="stat">Mistakes: <b id="miss">0</b></div>
        <div class="stat hint">Tip: use <span class="kbd">right-click</span> (menu disabled)</div>
    </div>

    <div id="arena" class="arena" aria-label="Game arena" role="application"></div>

    <div id="overlay" class="endcard">
        <div class="card">
            <h2>Time’s up!</h2>
            <p><b>Score:</b> <span id="finalScore">0</span> • <b>Mistakes:</b> <span id="finalMiss">0</span></p>
            <p class="hint">Targets: <span class="dot left"></span> left, <span class="dot right"></span> right, <span class="dot double"></span> double</p>
            <button id="playAgain">Play again</button>
        </div>
    </div>
</div>

<script>
  (() => {
    const arena = document.getElementById('arena');
    const startBtn = document.getElementById('startBtn');
    const resetBtn = document.getElementById('resetBtn');
    const secsInput = document.getElementById('seconds');
    const timeEl = document.getElementById('time');
    const scoreEl = document.getElementById('score');
    const missEl  = document.getElementById('miss');
    const overlay = document.getElementById('overlay');
    const finalScore = document.getElementById('finalScore');
    const finalMiss = document.getElementById('finalMiss');
    const playAgain = document.getElementById('playAgain');

    const TARGET_SIZE = 52; // px
    const MODES = ['left','right','double']; // green / red / blue
    const MODE_WEIGHTS = { left: 0.45, right: 0.35, double: 0.20 };

    const state = {
      running:false, timerId:null, timeLeft:60, score:0, mistakes:0, target:null
    };

    function pickMode() {
      const r = Math.random();
      let acc = 0;
      for (const m of MODES) { acc += MODE_WEIGHTS[m]; if (r <= acc) return m; }
      return 'left';
    }

    function randPos() {
      const rect = arena.getBoundingClientRect();
      const pad = TARGET_SIZE * 0.65;
      const x = Math.random() * (rect.width - pad*2) + pad;
      const y = Math.random() * (rect.height - pad*2) + pad;
      return { x, y };
    }

    function clearTarget() {
      if (state.target && state.target.isConnected) arena.removeChild(state.target);
      state.target = null;
    }

    function spawnTarget() {
      clearTarget();
      const t = document.createElement('div');
      const mode = pickMode();
      const { x, y } = randPos();
      t.className = `target ${mode}`;
      t.dataset.mode = mode;
      t.style.left = `${x}px`;
      t.style.top  = `${y}px`;
      t.title = mode === 'left' ? 'Left-click'
               : mode === 'right' ? 'Right-click'
               : 'Double-click';
      t.textContent = mode === 'left' ? 'Left' : mode === 'right' ? 'Right' : '2x';

      arena.appendChild(t);
      requestAnimationFrame(() => t.classList.add('show'));
      state.target = t;
    }

    function startGame() {
      if (state.running) return;
      state.timeLeft = clampSec(+secsInput.value || 60);
      state.score = 0; state.mistakes = 0;
      updateHUD();
      overlay.classList.remove('show');
      startBtn.disabled = true; resetBtn.disabled = false; secsInput.disabled = true;
      state.running = true;
      spawnTarget();
      state.timerId = setInterval(tick, 1000);
    }

    function resetGame() {
      stopGame();
      state.timeLeft = clampSec(+secsInput.value || 60);
      state.score = 0; state.mistakes = 0;
      updateHUD(); clearTarget();
      startBtn.disabled = false; resetBtn.disabled = true; secsInput.disabled = false;
      overlay.classList.remove('show');
    }

    function stopGame() {
      state.running = false;
      clearInterval(state.timerId); state.timerId = null;
      startBtn.disabled = false; secsInput.disabled = false;
    }

    function tick() {
      if (!state.running) return;
      state.timeLeft -= 1;
      updateHUD();
      if (state.timeLeft <= 0) {
        endGame();
      } else if (!state.target) {
        spawnTarget();
      }
    }

    function endGame() {
      stopGame();
      clearTarget();
      resetBtn.disabled = true;
      finalScore.textContent = state.score;
      finalMiss.textContent = state.mistakes;
      overlay.classList.add('show');
    }

    function updateHUD() {
      timeEl.textContent = Math.max(0, state.timeLeft);
      scoreEl.textContent = state.score;
      missEl.textContent = state.mistakes;
    }

    function clampSec(v){ return Math.max(10, Math.min(300, v|0)); }

    function handleHit(target) {
      target.classList.remove('show');
      setTimeout(() => {
        if (target.isConnected) arena.removeChild(target);
        if (state.running) spawnTarget();
      }, 120);
    }

    // Micro-feedback helpers
    function pulse(el){ el.classList.remove('pulse'); void el.offsetWidth; el.classList.add('pulse'); }
    function shake(el){ el.classList.remove('shake'); void el.offsetWidth; el.classList.add('shake'); }

    // Click rippleAt (inside arena only)
    function rippleAt(e){
      const rect = arena.getBoundingClientRect();
      const x = e.clientX - rect.left;  // viewport -> local
      const y = e.clientY - rect.top;

      const r = document.createElement('span');
      r.className = 'ripple';
      r.style.left = x + 'px';
      r.style.top  = y + 'px';
      arena.appendChild(r);
      setTimeout(() => r.remove(), 600);
    }



    // Core input handling
    arena.addEventListener('click', (e) => {
      if (!state.running) return;
      rippleAt(e);
      const t = e.target;
      if (!(t && t.classList.contains('target'))) return;

      const mode = t.dataset.mode;
      if (mode === 'left') {
        state.score += 1; updateHUD(); pulse(scoreEl); handleHit(t);
      } else if (mode !== 'double') {
        state.mistakes += 1; updateHUD(); shake(missEl);
      }
    });

    // Right-click
    arena.addEventListener('contextmenu', (e) => {
      if (!state.running) return;
      e.preventDefault();
      rippleAt(e);
      const t = e.target;
      if (!(t && t.classList.contains('target'))) return;
      const mode = t.dataset.mode;
      if (mode === 'right') {
        state.score += 1; updateHUD(); pulse(scoreEl); handleHit(t);
      } else {
        state.mistakes += 1; updateHUD(); shake(missEl);
      }
    });

    // Double-click
    arena.addEventListener('dblclick', (e) => {
      if (!state.running) return;
      rippleAt(e);
      const t = e.target;
      if (!(t && t.classList.contains('target'))) return;
      const mode = t.dataset.mode;
      if (mode === 'double') {
        state.score += 2; updateHUD(); pulse(scoreEl); handleHit(t);
      } else {
        state.mistakes += 1; updateHUD(); shake(missEl);
      }
    });

    // Controls
    startBtn.addEventListener('click', startGame);
    resetBtn.addEventListener('click', resetGame);
    playAgain.addEventListener('click', () => { resetGame(); startGame(); });

    // Keyboard quick start
    document.addEventListener('keydown', (e) => {
      if (e.key === 'Enter' && !state.running) startGame();
    });

    // Init
    updateHUD();
  })();
  </script>
</body>
</html>
